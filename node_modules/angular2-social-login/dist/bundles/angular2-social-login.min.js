"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _angular_core=require("@angular/core"),rxjs_Observable=require("rxjs/Observable"),__decorate$1=function(e,t,o,r){var n,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(i=(a<3?n(i):a>3?n(t,o,i):n(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};exports.AuthService=function(){function e(){}return e.prototype.login=function(e){var t=this;return rxjs_Observable.Observable.create(function(o){switch(e){case"google":void 0===t.gauth&&(t.gauth=gapi.auth2.getAuthInstance()),t.gauth.isSignedIn.get()?(localStorage.setItem("_login_provider","google"),o.next(t._fetchGoogleUserDetails()),o.complete()):t.gauth.signIn().then(function(){localStorage.setItem("_login_provider","google"),o.next(t._fetchGoogleUserDetails()),o.complete()});break;case"facebook":FB.getLoginStatus(function(e){"connected"===e.status?FB.api("/me?fields=name,email,picture",function(t){if(!t||t.error)o.error(t.error);else{var r={name:t.name,email:t.email,uid:t.id,provider:"facebook",image:t.picture.data.url,token:e.authResponse.accessToken};localStorage.setItem("_login_provider","facebook"),o.next(r),o.complete()}}):FB.login(function(e){"connected"===e.status&&FB.api("/me?fields=name,email,picture",function(t){if(!t||t.error)o.error(t.error);else{var r={name:t.name,email:t.email,uid:t.id,provider:"facebook",image:t.picture.data.url,token:e.authResponse.accessToken};localStorage.setItem("_login_provider","facebook"),o.next(r),o.complete()}})},{scope:"email"})});break;case"linkedin":IN.User.authorize(function(){IN.API.Raw("/people/~:(id,first-name,last-name,email-address,picture-url)").result(function(e){var t={name:e.firstName+" "+e.lastName,email:e.emailAddress,uid:e.id,provider:"linkedIN",image:e.pictureUrl};localStorage.setItem("_login_provider","linkedin"),o.next(t),o.complete()})})}})},e.prototype.logout=function(){var e=localStorage.getItem("_login_provider");return rxjs_Observable.Observable.create(function(t){switch(e){case"google":var o=document.getElementById("gSignout");void 0!==o&&null!=o&&o.remove();var r=document,n=void 0,a=r.getElementsByTagName("script")[0];n=r.createElement("script"),n.src="https://accounts.google.com/Logout",n.type="text/javascript",n.id="gSignout",localStorage.removeItem("_login_provider"),t.next(!0),t.complete(),a.parentNode.insertBefore(n,a);break;case"facebook":FB.logout(function(e){localStorage.removeItem("_login_provider"),t.next(!0),t.complete()});break;case"linkedin":IN.User.logout(function(){localStorage.removeItem("_login_provider"),t.next(!0),t.complete()},{})}})},e.prototype._fetchGoogleUserDetails=function(){var e=this.gauth.currentUser.get(),t=e.getBasicProfile();return{token:e.getAuthResponse().id_token,uid:t.getId(),name:t.getName(),email:t.getEmail(),image:t.getImageUrl(),provider:"google"}},e}(),exports.AuthService=__decorate$1([_angular_core.Injectable()],exports.AuthService);var __decorate=function(e,t,o,r){var n,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(i=(a<3?n(i):a>3?n(t,o,i):n(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};exports.Angular2SocialLoginModule=function(){function e(){}return e.loadProvidersScripts=function(e){var t={google:function(e){var t,o=document,r=o.getElementsByTagName("script")[0];t=o.createElement("script"),t.async=!0,t.src="//apis.google.com/js/platform.js",t.onload=function(){gapi.load("auth2",function(){gapi.auth2.init({client_id:e.clientId,scope:"email"})})},r.parentNode.insertBefore(t,r)},linkedin:function(e){var t,o=document,r=o.getElementsByTagName("script")[0];t=o.createElement("script"),t.async=!1,t.src="//platform.linkedin.com/in.js",t.text=("api_key: "+e.clientId).replace('"',""),r.parentNode.insertBefore(t,r)},facebook:function(e){var t,o=document,r=o.getElementsByTagName("script")[0];t=o.createElement("script"),t.id="facebook-jssdk",t.async=!0,t.src="//connect.facebook.net/en_US/sdk.js",t.onload=function(){FB.init({appId:e.clientId,status:!0,cookie:!0,xfbml:!0,version:e.apiVersion})},r.parentNode.insertBefore(t,r)}};Object.keys(e).forEach(function(o){t[o](e[o])})},e}(),exports.Angular2SocialLoginModule=__decorate([_angular_core.NgModule({providers:[exports.AuthService]})],exports.Angular2SocialLoginModule);